# SPT - Åantiye Proje Takip Sistemi

Ä°nÅŸaat ÅŸantiyelerinin yÃ¶netimi iÃ§in geliÅŸtirilmiÅŸ kapsamlÄ± proje takip sistemi.

## Ã–zellikler

### Puantaj YÃ¶netimi
- **GeliÅŸmiÅŸ Onay Sistemi**: Ã‡ok aÅŸamalÄ± onay sÃ¼reci (draft, submitted, approved, rejected)
- **Onay LoglarÄ±**: TÃ¼m onay iÅŸlemlerinin detaylÄ± kayÄ±tlarÄ±
- **Ä°K MÃ¼dahale Sistemi**: Ä°K'nÄ±n onaylanmÄ±ÅŸ puantajlara mÃ¼dahale edebilmesi
- **Ä°zin Entegrasyonu**: Ä°zin taleplerinin otomatik puantaja yansÄ±masÄ±
- **Fazla Mesai Takibi**: Hafta iÃ§i (%50), hafta sonu (%100), resmi tatil (%200)
- **HaftalÄ±k Hesaplamalar**: Otomatik haftalÄ±k Ã¶zet ve fazla mesai hesaplamalarÄ±
- **Toplu GiriÅŸ**: AylÄ±k veya haftalÄ±k toplu puantaj giriÅŸi
- **Proje Detay Takibi**: YapÄ±, kat, daire ve iÅŸ kalemi bazÄ±nda detaylÄ± kayÄ±t

### Ã‡alÄ±ÅŸan YÃ¶netimi
- Ã‡alÄ±ÅŸan bilgileri ve departman atamalarÄ±
- Vardiya yÃ¶netimi
- MaaÅŸ geÃ§miÅŸi takibi
- Proje atamalarÄ±
- TaÅŸeron Ã§alÄ±ÅŸan desteÄŸi

### Ä°zin YÃ¶netimi
- YÄ±llÄ±k izin, hastalÄ±k izni, Ã¼cretsiz izin vb. tÃ¼m izin tipleri
- **Resmi Tatil YÃ¶netimi**: Arefe (yarÄ±m gÃ¼n) desteÄŸi ile
- **AkÄ±llÄ± Ä°zin Hesaplama**: Proje bazlÄ± hafta tatili + resmi tatil entegrasyonu
- Otomatik izin bakiyesi hesaplama
- Ä°zin onay sÃ¼reci
- Ä°zin-puantaj senkronizasyonu
- DetaylÄ± izin bakiyesi loglarÄ±

### Proje YÃ¶netimi
- Proje yapÄ± ve kat tanÄ±mlamalarÄ±
- **Ã–zelleÅŸtirilebilir Hafta Tatili**: Proje bazÄ±nda hafta sonu gÃ¼nleri
- Ä°ÅŸ kalemleri ve metraj takibi
- Proje-departman iliÅŸkileri
- TaÅŸeron firma yÃ¶netimi
- Proje dokÃ¼mantasyonu

### SatÄ±n Alma ModÃ¼lÃ¼
- SatÄ±n alma talepleri
- TedarikÃ§i yÃ¶netimi
- Teklif karÅŸÄ±laÅŸtÄ±rma
- SipariÅŸ takibi
- Teslimat yÃ¶netimi

### KeÅŸif & Metraj ModÃ¼lÃ¼ ğŸ†•
- **Proje YapÄ±sÄ± Entegrasyonu**: YapÄ±/Kat/Birim bazlÄ± metraj kayÄ±tlarÄ±
- **Ä°ÅŸ Kalemi Takibi**: Ä°ÅŸ kalemleri ile iliÅŸkilendirilmiÅŸ metraj hesaplama
- **Planlanan ve Tamamlanan**: Metraj planlama ve gerÃ§ekleÅŸme takibi
- **HakediÅŸ Entegrasyonu**: Metraj kayÄ±tlarÄ±ndan hakediÅŸ oluÅŸturma
- **Ä°lerleme Ä°zleme**: Tamamlanma yÃ¼zdesi ve kalan miktar hesaplama
- **Ã–lÃ§Ã¼m YÃ¶ntemleri**: FarklÄ± Ã¶lÃ§Ã¼m yÃ¶ntemleri desteÄŸi
- **Onay SÃ¼reci**: DoÄŸrulama ve onaylama akÄ±ÅŸÄ±
- **Proje Show SayfasÄ±**: Metraj kayÄ±tlarÄ± tab gÃ¶rÃ¼nÃ¼mÃ¼

### HakediÅŸ ModÃ¼lÃ¼
- **Metraj BazlÄ± HakediÅŸ**: KeÅŸif/Metraj kayÄ±tlarÄ±ndan otomatik veri Ã§ekme
- **AkÄ±llÄ± Form**: Proje/yapÄ±/kat/birim seÃ§imine gÃ¶re ilgili metraj bulma
- **Otomatik Limit KontrolÃ¼**: Kalan hakediÅŸ yapÄ±labilir miktar hesaplama
- **Metraj AÅŸÄ±mÄ± Takibi**: Planlanan metrajÄ± aÅŸan hakediÅŸ kayÄ±tlarÄ±nÄ±n otomatik tespiti
- **AÅŸÄ±m Raporu**: Metraj aÅŸÄ±mÄ± kayÄ±tlarÄ±nÄ±n filtrelenebilir raporu
- **AÅŸÄ±m UyarÄ±larÄ±**: KullanÄ±cÄ±ya aÅŸÄ±m durumunda gÃ¶rsel uyarÄ±
- Ä°ÅŸ kalemi bazlÄ± metraj takibi
- Onay sÃ¼reci (completed â†’ approved â†’ paid)
- Ã–deme durumu takibi
- Proje yapÄ±/kat/birim detaylÄ± kayÄ±t
- **Metraj Ä°liÅŸkisi**: Her hakediÅŸ metraj kaydÄ±na baÄŸlÄ±

### Finansal YÃ¶netim ModÃ¼lÃ¼ ğŸ†•
- **Event-Driven Otomatik KayÄ±t**: Puantaj, HakediÅŸ, SatÄ±nalma modÃ¼llerinden
- **Gelir/Gider Kategorileri**: HiyerarÅŸik kategori yapÄ±sÄ±
- **Ã–deme Takibi**: Beklemede, KÄ±smi, Ã–dendi durumlarÄ±
- **Kar/Zarar RaporlarÄ±**: Proje, yÄ±l, ay bazlÄ± analiz
- **Dashboard**: Ã–zet finansal widget'lar
- **BÃ¼tÃ§e vs GerÃ§ekleÅŸen**: Varyans analizi

### SÃ¶zleÅŸme YÃ¶netimi ModÃ¼lÃ¼ ğŸ†•
- **TaÅŸeron/TedarikÃ§i SÃ¶zleÅŸmeleri**: Merkezi sÃ¶zleÅŸme yÃ¶netim sistemi
- **Otomatik NumaralandÄ±rma**: Duplicate-safe sÃ¶zleÅŸme numarasÄ± oluÅŸturma (PRJ-CODE-TS-YYYY-0001)
- **Teminat YÃ¶netimi**: Banka Mektubu, Nakit, Ã‡ek, TeminatsÄ±z seÃ§enekleri
- **Durum YÃ¶netimi**: Draft â†’ Active â†’ Completed/Terminated/Expired lifecycle
- **HakediÅŸ Entegrasyonu**: SÃ¶zleÅŸmelere baÄŸlÄ± hakediÅŸ kayÄ±tlarÄ±
- **SatÄ±nalma Entegrasyonu**: Opsiyonel sÃ¶zleÅŸme baÄŸlantÄ±sÄ±
- **Proje Entegrasyonu**: Proje detay sayfasÄ±nda sÃ¶zleÅŸmeler tabÄ±
- **Dashboard**: Ä°statistikler, sÃ¼resi dolacak sÃ¶zleÅŸmeler, son sÃ¶zleÅŸmeler
- **Filtreleme**: Proje, taÅŸeron, durum, tarih bazlÄ± arama
- **SÃ¼re Takibi**: SÃ¶zleÅŸme sÃ¼resi dolacak olanlar iÃ§in otomatik uyarÄ±

### SatÄ±ÅŸ ve Tapu YÃ¶netimi ModÃ¼lÃ¼ ğŸ†•
- **MÃ¼ÅŸteri CRM**: Bireysel ve kurumsal mÃ¼ÅŸteri yÃ¶netimi
- **SatÄ±ÅŸ YÃ¶netimi**: Rezervasyon, kesin satÄ±ÅŸ, Ã¶n satÄ±ÅŸ sÃ¼reÃ§leri
- **Otomatik Ã–deme PlanÄ±**: PeÅŸinat + taksit planlamasÄ±
- **Ã–deme Takibi**: DetaylÄ± taksit ve Ã¶deme durumu izleme
- **Cascade Dropdown**: Proje â†’ Blok â†’ Kat â†’ Birim hiyerarÅŸik seÃ§imi
- **SatÄ±ÅŸ Durumu GÃ¶rselleÅŸtirme**:
  - Proje bazlÄ± satÄ±ÅŸ istatistikleri ve dashboard
  - Blok seÃ§imi ve kat bazlÄ± progress bar'lar
  - Renk kodlu birim grid (MÃ¼sait, SatÄ±ldÄ±, Rezerve, GecikmiÅŸ)
  - Ä°nteraktif birim kartlarÄ± ve detay modal'larÄ±
  - MÃ¼ÅŸteri ve fiyat bilgileri ile hover tooltips
- **Basit Tapu Takibi**:
  - Tapu durumu yÃ¶netimi (Devredilmedi, Ä°ÅŸlemde, Devredildi, Ertelendi)
  - Tapu belgesi yÃ¼kleme sistemi (PDF, JPG, PNG - Max 10MB)
  - Tapu bilgileri (Tip, Numara, Devir Tarihi, Notlar)
  - Modal-based gÃ¼ncelleme ve belge yÃ¶netimi
- **Finansal Entegrasyon**: SatÄ±ÅŸ Ã¶demelerinden otomatik gelir kaydÄ± (Event-driven ready)

### YapÄ± Denetim Sistemi ModÃ¼lÃ¼ ğŸ†•
- **Denetim KuruluÅŸlarÄ± YÃ¶netimi**: LisanslÄ± yapÄ± denetim firmalarÄ±nÄ±n takibi
- **Denetim KayÄ±tlarÄ±**: Periyodik, Ã¶zel ve final denetim kayÄ±tlarÄ±
- **Otomatik Denetim NumaralandÄ±rma**: Duplicate-safe numara oluÅŸturma (DEN-PRJ-YYYY-001)
- **Uygunsuzluk Takibi**: Minor, Major, Critical seviyelerinde uygunsuzluk kayÄ±tlarÄ±
- **DÃ¼zeltici Faaliyetler**: Uygunsuzluklara karÅŸÄ± aksiyonlarÄ±n takibi ve durumu
- **Denetim RaporlarÄ±**: PDF rapor yÃ¼kleme ve ek dosya yÃ¶netimi
- **Denetim TÃ¼rleri**: Periyodik (3 aylÄ±k), Ã–zel, Final denetimleri
- **Durum YÃ¶netimi**: Scheduled â†’ Completed â†’ Pending Action â†’ Closed lifecycle
- **Dashboard**: Ä°statistikler, yaklaÅŸan/gecikmiÅŸ denetimler, uygunsuzluk sayÄ±larÄ±
- **Filtreleme**: Proje, denetim kuruluÅŸu, tÃ¼r, durum, tarih bazlÄ± arama
- **Ruhsat YÃ¶netimi**:
  - YapÄ± RuhsatÄ± (Building Permit) takibi
  - Ä°skan Ä°zni (Occupancy Permit) yÃ¶netimi
  - YapÄ± Kullanma Ä°zni (Usage Permit) kayÄ±tlarÄ±
  - Otomatik ruhsat numarasÄ± oluÅŸturma (YR-PRJ-YYYY-001)
  - Ä°mar durumu ve ihraÃ§ makamÄ± bilgileri

## Teknoloji Stack

- **Backend**: Laravel 11
- **Frontend**: Vue.js 3 + Inertia.js
- **VeritabanÄ±**: MariaDB / MySQL
- **Authentication**: Laravel Sanctum
- **Yetkilendirme**: Spatie Laravel Permission

## Kurulum

### Gereksinimler
- PHP 8.2+
- Composer
- Node.js 18+
- MariaDB 10.6+ veya MySQL 8.0+

### AdÄ±mlar

1. BaÄŸÄ±mlÄ±lÄ±klarÄ± yÃ¼kleyin:
```bash
composer install
npm install
```

2. Environment dosyasÄ±nÄ± yapÄ±landÄ±rÄ±n:
```bash
cp .env.example .env
php artisan key:generate
```

3. VeritabanÄ±nÄ± oluÅŸturun ve migration'larÄ± Ã§alÄ±ÅŸtÄ±rÄ±n:
```bash
php artisan migrate --seed
```

4. Frontend asset'lerini derleyin:
```bash
npm run build
```

5. UygulamayÄ± Ã§alÄ±ÅŸtÄ±rÄ±n:
```bash
php artisan serve
```

## VeritabanÄ± YapÄ±sÄ±

### Ana Tablolar
- `timesheets`: Puantaj kayÄ±tlarÄ± (geliÅŸmiÅŸ onay sistemi ile)
- `employees`: Ã‡alÄ±ÅŸan bilgileri
- `projects`: Proje tanÄ±mlarÄ±
- `leave_requests`: Ä°zin talepleri
- `timesheet_approval_logs`: Puantaj onay geÃ§miÅŸi
- `shifts`: Vardiya tanÄ±mlarÄ±
- `departments`: Departman tanÄ±mlarÄ±

### Yedek Tablolar
- `timesheets_old_backup`: Eski puantaj sistemi (referans iÃ§in)
- `timesheets_v3_backup`: V3 puantaj sistemi (referans iÃ§in)

## GeliÅŸtirme NotlarÄ±

### Son GÃ¼ncellemeler

#### 28 Ekim 2025 - YapÄ± Denetim Sistemi ModÃ¼lÃ¼ TamamlandÄ± ğŸ‰
- **Denetim KuruluÅŸlarÄ± YÃ¶netimi**: Lisans numarasÄ±, iletiÅŸim bilgileri, aktif/pasif durum
- **Denetim KayÄ±tlarÄ± Sistemi**: Periyodik, Ã¶zel ve final denetim tÃ¼rleri
- **Otomatik NumaralandÄ±rma**: Duplicate-safe denetim numarasÄ± (DEN-PRJ-YYYY-001)
- **Uygunsuzluk YÃ¶netimi**:
  - 3 Seviye: Minor (kÃ¼Ã§Ã¼k), Major (bÃ¼yÃ¼k), Critical (kritik)
  - FotoÄŸraf yÃ¼kleme ve son tarih takibi
  - Kritik uygunsuzluk sayacÄ±
- **DÃ¼zeltici Faaliyetler**:
  - Sorumlu kiÅŸi ve son tarih atamasÄ±
  - Durum takibi (Pending, In Progress, Completed)
  - Tamamlanma tarihi kaydÄ±
- **Rapor YÃ¶netimi**:
  - PDF rapor yÃ¼kleme (10MB limit)
  - SÄ±nÄ±rsÄ±z ek dosya desteÄŸi
  - Dosya meta bilgileri (isim, tip, boyut, tarih)
- **Dashboard**:
  - Toplam/planlanan/bekleyen denetim sayÄ±larÄ±
  - Kritik uygunsuzluk sayacÄ±
  - YaklaÅŸan denetimler (7 gÃ¼n iÃ§inde)
  - GecikmiÅŸ denetim uyarÄ±larÄ±
  - Denetim tÃ¼rÃ¼ daÄŸÄ±lÄ±mÄ±
- **Ruhsat YÃ¶netimi**:
  - YapÄ± RuhsatÄ± (Building), Ä°skan Ä°zni (Occupancy), Kullanma Ä°zni (Usage)
  - Otomatik ruhsat numaralarÄ± (YR/Ä°Ä°/YKÄ°-PRJ-YYYY-001)
  - Ä°hraÃ§ makamÄ± ve imar durumu bilgileri
  - BaÅŸvuru, onay, geÃ§erlilik tarihleri
- **8 Vue SayfasÄ±**: Full-width modern tasarÄ±m (purple gradient)
- **Seeders**: 5 denetim kuruluÅŸu + otomatik periyodik denetimler + ruhsat kayÄ±tlarÄ±
- **Routes**: `/inspections/*` ve `/inspection-companies/*` altÄ±nda organize edildi
- **Sidebar Entegrasyonu**: "YapÄ± Denetim" menÃ¼ grubu eklendi

#### 27 Ekim 2025 - SatÄ±ÅŸ ve Tapu YÃ¶netimi ModÃ¼lÃ¼ TamamlandÄ± ğŸ‰
- **SatÄ±ÅŸ Durumu GÃ¶rselleÅŸtirme Sistemi**: Proje bazlÄ± interaktif satÄ±ÅŸ dashboard'u
- **Renk Kodlu Birim Grid**: Blok/Kat/Birim hiyerarÅŸik gÃ¶rÃ¼nÃ¼mÃ¼
- **4 Renk Durumu**: MÃ¼sait (yeÅŸil), SatÄ±ldÄ± (kÄ±rmÄ±zÄ±), Rezerve (sarÄ±), GecikmiÅŸ (turuncu)
- **Ä°nteraktif Kartlar**: Hover tooltips ve detay modal'larÄ±
- **SatÄ±ÅŸ Ä°statistikleri**: Toplam, satÄ±lan, rezerve, mÃ¼sait birim sayÄ±larÄ±
- **Progress Bar'lar**: Kat bazlÄ± satÄ±ÅŸ tamamlanma oranlarÄ±
- **Basit Tapu Takibi**:
  - Modal-based tapu durumu gÃ¼ncelleme formu
  - Tapu belgesi yÃ¼kleme (PDF, JPG, PNG - 10MB)
  - Tapu bilgileri (Tip, numara, devir tarihi, notlar)
  - UnitSale Show sayfasÄ±nda interaktif tapu bÃ¶lÃ¼mÃ¼
- **3 Vue SayfasÄ±**: SalesStatus Index, Show + UnitSale Show gÃ¼ncelleme
- **SalesStatusController**: 4 endpoint (index, show, structure details, floor units)
- **Routes**: `/sales/sales-status` altÄ±nda organize edildi
- **Sidebar Entegrasyonu**: "SatÄ±ÅŸ Durumu" menÃ¼ Ã¶ÄŸesi eklendi
- **Bug Fix**: Blok seÃ§imi sorunu dÃ¼zeltildi (floor_order â†’ floor_number) âœ…

#### 26 Ekim 2025 - SÃ¶zleÅŸme YÃ¶netimi ModÃ¼lÃ¼ TamamlandÄ± ğŸ‰
- **Merkezi SÃ¶zleÅŸme Sistemi**: TaÅŸeron ve tedarikÃ§i sÃ¶zleÅŸmelerinin tek noktadan yÃ¶netimi
- **3 Migration**: contracts table, progress_payments contract_id, purchasing_requests contract_id
- **Otomatik NumaralandÄ±rma**: Duplicate-safe sÃ¶zleÅŸme numarasÄ± (PRJ-CODE-TS-YYYY-0001)
- **Teminat YÃ¶netimi**: Banka Mektubu, Nakit, Ã‡ek, TeminatsÄ±z seÃ§enekleri
- **Lifecycle Management**: Draft â†’ Active â†’ Completed/Terminated/Expired durum akÄ±ÅŸÄ±
- **Proje Entegrasyonu**:
  - Project Show sayfasÄ±na SÃ¶zleÅŸmeler tabÄ± eklendi
  - Proje seÃ§imi ile otomatik form doldurma
- **HakediÅŸ Entegrasyonu**: HakediÅŸ kayÄ±tlarÄ±na contract_id baÄŸlantÄ±sÄ±
- **Dashboard**: Ä°statistikler, sÃ¼resi dolacak sÃ¶zleÅŸmeler (30 gÃ¼n), son sÃ¶zleÅŸmeler
- **Filtreleme Sistemi**: Proje, taÅŸeron, durum, tarih bazlÄ± arama
- **ContractService**: Business logic, otomatik numaralandÄ±rma, lifecycle methods
- **5 Vue SayfasÄ±**: Dashboard, Index, Show, Create, Edit (full-width tasarÄ±m)
- **Form Validation**: Comprehensive hata gÃ¶sterimi (genel liste + input bazlÄ±)
- **15 Seeder KayÄ±t**: Test verisi ile sistem hazÄ±r

#### 26 Ekim 2025 - KeÅŸif/Metraj ve HakediÅŸ Entegrasyonu ğŸ¯
- **Metraj-HakediÅŸ Ä°liÅŸkisi**: Ä°ÅŸ akÄ±ÅŸÄ± dÃ¼zeltildi (Metraj â†’ HakediÅŸ)
- **AkÄ±llÄ± HakediÅŸ Formu**: Proje/yapÄ±/kat/birim seÃ§ince otomatik metraj bulma
- **Otomatik Limit KontrolÃ¼**: Daha Ã¶nce hakediÅŸ yapÄ±lan miktarÄ± Ã§Ä±karÄ±p kullanÄ±labilir kalan gÃ¶sterir
- **Ä°liÅŸkili KayÄ±t GÃ¶rÃ¼nÃ¼mÃ¼**:
  - Proje Show'da KeÅŸif/Metraj tabÄ± eklendi
  - Metraj Show'da Ä°liÅŸkili HakediÅŸ widget'Ä± eklendi
- **Backend Ä°yileÅŸtirmeler**:
  - QuantityController'a search() API endpoint eklendi
  - Project-Quantity relationship eklendi
  - Null-safe accessor metodlarÄ± gÃ¼ncellendi
- **Frontend Ä°yileÅŸtirmeler**:
  - HakediÅŸ form'unda metraj bilgi widget'Ä± (yeÅŸil: bulundu, sarÄ±: bulunamadÄ±)
  - Quantity Stats computed properties
  - Payment status labels ve variant helpers

#### 26 Ekim 2025 - Finansal YÃ¶netim ModÃ¼lÃ¼ TamamlandÄ± ğŸ‰
- **Event-Driven Finansal Sistem**: Puantaj, HakediÅŸ, SatÄ±nalma onaylarÄ±ndan otomatik finansal kayÄ±t
- **Gelir/Gider Kategori YÃ¶netimi**: HiyerarÅŸik yapÄ± ile esnek kategorizasyon
- **Kar/Zarar RaporlarÄ±**: Proje ve kategori bazlÄ± detaylÄ± analiz
- **Financial Dashboard**: Gelir, gider, kar marjÄ± Ã¶zet kartlarÄ±
- **Ã–deme Durumu Takibi**: OnaylÄ± puantajlar otomatik "Ã¶dendi" olarak iÅŸaretlenir
- **BÃ¼tÃ§e vs GerÃ§ekleÅŸen**: Otomatik varyans hesaplamasÄ±
- 6 Vue sayfasÄ± + Full-width profesyonel tasarÄ±m

#### 24 Ekim 2025 - Ä°zin ve Tatil Sistemi
- **Resmi Tatil Sistemi**: Arefe (yarÄ±m gÃ¼n) desteÄŸi ile eklendi
- **Proje BazlÄ± Hafta Tatili**: Her proje iÃ§in Ã¶zelleÅŸtirilebilir hafta sonu gÃ¼nleri
- **AkÄ±llÄ± Ä°zin Hesaplama**: Proje kurallarÄ± + resmi tatiller entegre edildi
- TÃ¼m puantaj versiyonlarÄ± (`timesheets_v2`, `timesheets_v3`) tek bir `timesheets` tablosunda birleÅŸtirildi
- Model isimleri standartlaÅŸtÄ±rÄ±ldÄ± (`TimesheetV2` â†’ `Timesheet`)
- GeliÅŸmiÅŸ onay sistemi ve haftalÄ±k hesaplama Ã¶zenlikleri eklendi
- Ä°zin-puantaj entegrasyonu tamamlandÄ±

## DokÃ¼mantasyon

DetaylÄ± proje planÄ± ve durum takibi iÃ§in:
- **[docs/PROJE_PLANI.md](docs/PROJE_PLANI.md)** - KapsamlÄ± proje planÄ±, tamamlanan gÃ¶revler, yapÄ±lacaklar listesi

## Lisans

Bu proje MIT lisansÄ± altÄ±nda lisanslanmÄ±ÅŸtÄ±r.
